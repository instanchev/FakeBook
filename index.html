import { useState } from 'react';
import { BrowserRouter as Router, Route, Routes, Link } from 'react-router-dom';

// –ü—Ä–∏–º–µ—Ä–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ (—Ç–≤–æ–∏ –∞–∫–∞—É–Ω—Ç–∏)
const users = [
  {
    id: 1,
    name: "–ò–≤–∞–Ω –ì–µ–æ—Ä–≥–∏–µ–≤",
    cover: "https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1350&q=80",
    avatar: "https://randomuser.me/api/portraits/men/45.jpg",
    posts: ["–ó–¥—Ä–∞–≤–µ–π, –Ø–º–±–æ–ª!"],
  },
  {
    id: 2,
    name: "–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
    cover: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=1350&q=80",
    avatar: "https://randomuser.me/api/portraits/women/65.jpg",
    posts: ["FaceYambol –µ —Å—É–ø–µ—Ä!"],
  }
];

// 40 –∞–∫–∞—É–Ω—Ç–∞ –∑–∞ "–•–æ—Ä–∞, –∫–æ–∏—Ç–æ –º–æ–∂–µ –±–∏ –ø–æ–∑–Ω–∞–≤–∞—Ç–µ"
const suggestedUsers = Array.from({ length: 40 }, (_, i) => {
  const gender = i % 2 === 0 ? "men" : "women";
  return {
    id: 1000 + i,
    name: `–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª ${i + 1}`,
    avatar: `https://randomuser.me/api/portraits/${gender}/${i + 10}.jpg`,
  };
});

function PeopleYouMayKnow() {
  return (
    <div className="bg-white rounded-xl shadow p-4 max-w-3xl mx-auto mt-6">
      <h3 className="text-xl font-semibold mb-4">–•–æ—Ä–∞, –∫–æ–∏—Ç–æ –º–æ–∂–µ –±–∏ –ø–æ–∑–Ω–∞–≤–∞—Ç–µ</h3>
      <div className="grid grid-cols-4 gap-4 max-h-96 overflow-y-auto">
        {suggestedUsers.map(user => (
          <div key={user.id} className="flex flex-col items-center text-center p-2 hover:bg-gray-100 rounded cursor-pointer">
            <img
              src={user.avatar}
              alt={user.name}
              className="w-16 h-16 rounded-full mb-2 object-cover"
              loading="lazy"
            />
            <span className="text-sm font-medium">{user.name}</span>
            <button className="mt-1 text-xs text-blue-600 hover:underline">–î–æ–±–∞–≤–∏</button>
          </div>
        ))}
      </div>
    </div>
  );
}

function Home({ currentUser, setCurrentUser }) {
  const [newPost, setNewPost] = useState("");

  const handlePost = () => {
    if (newPost.trim()) {
      const updatedUser = {
        ...currentUser,
        posts: [newPost, ...currentUser.posts],
      };
      setCurrentUser(updatedUser);
      setNewPost("");
    }
  };

  return (
    <div className="flex flex-col items-center p-4">
      <div className="w-full max-w-3xl bg-white rounded-xl shadow-lg overflow-hidden">
        {/* –ö–æ—Ä–∏—á–Ω–∞ —Å–Ω–∏–º–∫–∞ */}
        <div className="relative">
          <img src={currentUser.cover} alt="Cover" className="w-full h-60 object-cover" />
          <img
            src={currentUser.avatar}
            alt="Avatar"
            className="w-28 h-28 rounded-full border-4 border-white shadow-md absolute left-6 -bottom-14"
          />
        </div>
        <div className="pt-20 pb-4 px-6">
          <h2 className="text-2xl font-bold">{currentUser.name}</h2>
          <Link to="/chat">
            <button className="mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">–ò–∑–ø—Ä–∞—Ç–∏ —Å—ä–æ–±—â–µ–Ω–∏–µ</button>
          </Link>
        </div>

        {/* –°—ä–∑–¥–∞–π –ø–æ—Å—Ç */}
        <div className="bg-gray-50 px-6 py-4">
          <input
            type="text"
            placeholder={`–ö–∞–∫–≤–æ –º–∏—Å–ª–∏—à, ${currentUser.name.split(" ")[0]}?`}
            value={newPost}
            onChange={(e) => setNewPost(e.target.value)}
            className="w-full p-2 border rounded mb-2"
          />
          <button
            onClick={handlePost}
            className="w-full bg-green-500 text-white py-2 rounded hover:bg-green-600"
          >
            –ü—É–±–ª–∏–∫—É–≤–∞–π
          </button>
        </div>

        {/* –ü–æ—Å—Ç–æ–≤–µ */}
        <div className="px-6 py-4 space-y-4">
          {currentUser.posts.length > 0 ? (
            currentUser.posts.map((post, i) => (
              <div key={i} className="p-4 bg-white border rounded shadow-sm">
                {post}
              </div>
            ))
          ) : (
            <div className="text-center text-gray-500 py-10">–í—Å–µ –æ—â–µ –Ω—è–º–∞—à –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.</div>
          )}
        </div>
      </div>

      {/* –•–æ—Ä–∞, –∫–æ–∏—Ç–æ –º–æ–∂–µ –±–∏ –ø–æ–∑–Ω–∞–≤–∞—Ç–µ */}
      <PeopleYouMayKnow />
    </div>
  );
}

function Chat() {
  const [messages, setMessages] = useState([
    { from: "ai", text: "–ó–¥—Ä–∞–≤–µ–π! –ê–∑ —Å—ä–º —Ç–≤–æ—è—Ç AI –ø–æ–º–æ—â–Ω–∏–∫. –ö–∞–∫ –º–æ–≥–∞ –¥–∞ –ø–æ–º–æ–≥–Ω–∞?" },
  ]);
  const [input, setInput] = useState("");

  const handleSend = () => {
    if (input.trim() === "") return;

    const userMessage = { from: "user", text: input };
    setMessages((prev) => [...prev, userMessage]);

    // –°–∏–º—É–ª–∏—Ä–∞–Ω AI –æ—Ç–≥–æ–≤–æ—Ä
    const botReply = generateAIReply(input);
    setTimeout(() => {
      setMessages((prev) => [...prev, { from: "ai", text: botReply }]);
    }, 600);

    setInput("");
  };

  // –°–∏–º—É–ª–∏—Ä–∞–Ω–∞ AI –ª–æ–≥–∏–∫–∞ (–º–æ–∂–µ –¥–∞ —Å–µ –∑–∞–º–µ–Ω–∏ —Å API)
  function generateAIReply(message) {
    message = message.toLowerCase();
    if (message.includes("–∑–¥—Ä–∞–≤–µ–π") || message.includes("–∑–¥—Ä–∞—Å—Ç–∏")) {
      return "–ó–¥—Ä–∞—Å—Ç–∏! –†–∞–¥–≤–∞–º —Å–µ –¥–∞ —Ç–µ –≤–∏–¥—è —Ç—É–∫! üòä";
    }
    if (message.includes("–∫–∞–∫ —Å–∏")) {
      return "–ë–ª–∞–≥–æ–¥–∞—Ä—è, –¥–æ–±—Ä–µ —Å—ä–º! –ê —Ç–∏ –∫–∞–∫ —Å–∏?";
    }
    if (message.includes("–≤—Ä–µ–º–µ—Ç–æ")) {
      return "–î–Ω–µ—Å –≤—Ä–µ–º–µ—Ç–æ –≤ –Ø–º–±–æ–ª –µ —á—É–¥–µ—Å–Ω–æ –∑–∞ —Ä–∞–∑—Ö–æ–¥–∫–∞!";
    }
    return "–•–º–º... –∏–Ω—Ç–µ—Ä–µ—Å–µ–Ω –≤—ä–ø—Ä–æ—Å! –©–µ –ø–æ–º–∏—Å–ª—è –Ω–∞–¥ –Ω–µ–≥–æ. ü§î";
  }

  return (
    <div className="p-6 flex flex-col items-center">
      <div className="w-full max-w-2xl bg-white rounded-xl shadow-lg p-4">
        <h2 className="text-2xl font-bold mb-4 text-center text-blue-700">–ß–∞—Ç —Å AI</h2>

        <div className="h-96 overflow-y-auto space-y-3 p-2 border rounded bg-gray-50 flex flex-col">
          {messages.map((msg, i) => (
            <div
              key={i}
              className={`max-w-[75%] p-2 rounded-xl text-white ${
                msg.from === "user" ? "bg-blue-600 self-end ml-auto" : "bg-gray-600 self-start mr-auto"
              }`}
            >
              {msg.text}
            </div>
          ))}
        </div>

        <div className="flex gap-2 mt-4">
          <input
            value={input}
            onChange={(e) => setInput(e.target.value)}
            onKeyDown={(e) => e.key === "Enter" && handleSend()}
            placeholder="–ù–∞–ø–∏—à–∏ –Ω–µ—â–æ..."
            className="flex-grow border rounded px-3 py-2"
          />
          <button
            onClick={handleSend}
            className="bg-green-600 hover:bg-green-700 text-white px-4 rounded"
          >
            –ò–∑–ø—Ä–∞—Ç–∏
          </button>
        </div>
      </div>
    </div>
  );
}

function Notifications() {
  return (
    <div className="p-6 text-center text-lg text-gray-600">
      <h2 className="text-2xl font-bold mb-4">–ò–∑–≤–µ—Å—Ç–∏—è</h2>
      –í—Å–µ –æ—â–µ –Ω—è–º–∞ –Ω–æ–≤–∏ –∏–∑–≤–µ—Å—Ç–∏—è.
    </div>
  );
}

export default function FaceYambolApp() {
  const [currentUser, setCurrentUser] = useState(users[0]);

  return (
    <Router>
      <div className="min-h-screen bg-gradient-to-br from-blue-100 to-purple-200">
        {/* –•–µ–¥—ä—Ä */}
        <header className="bg-blue-700 text-white p-6 text-center text-3xl font-bold shadow-md flex justify-center items-center gap-3">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg"
            alt="logo"
            className="w-8 h-8"
          />
          FaceYambol
        </header>

        {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */}
        <nav className="bg-white shadow flex justify-center gap-8 py-4 text-blue-700 font-medium">
          <Link to="/" className="hover:underline">–ü—Ä–æ—Ñ–∏–ª</Link>
          <Link to="/chat" className="hover:underline">–ß–∞—Ç</Link>
          <Link to="/notifications" className="hover:underline">–ò–∑–≤–µ—Å—Ç–∏—è</Link>
        </nav>

        {/* –°—Ç—Ä–∞–Ω–∏—Ü–∏ */}
        <Routes>
          <Route path="/" element={<Home currentUser={currentUser} setCurrentUser={setCurrentUser} />} />
          <Route path="/chat" element={<Chat />} />
          <Route path="/notifications" element={<Notifications />} />
        </Routes>
      </div>
    </Router>
  );
}
